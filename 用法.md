# Nitter X ä½¿ç”¨æŒ‡å—

## ç›®å½•

1. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
2. [Nitter å®ä¾‹ç®¡ç†](#nitter-å®ä¾‹ç®¡ç†)
3. [ç”¨æˆ·ç®¡ç†](#ç”¨æˆ·ç®¡ç†)
4. [æ¨æ–‡é‡‡é›†](#æ¨æ–‡é‡‡é›†)
5. [æ•°æ®æŸ¥è¯¢](#æ•°æ®æŸ¥è¯¢)
6. [ç³»ç»Ÿæµ‹è¯•](#ç³»ç»Ÿæµ‹è¯•)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨åŸºç¡€æœåŠ¡

```bash
# å¯åŠ¨ PostgreSQL å’Œ Redis
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs -f
```

### 2. å®‰è£… Python ä¾èµ–

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœæœ‰ï¼‰
source .venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 3. æµ‹è¯•ç³»ç»Ÿ

```bash
# è¿è¡Œç³»ç»Ÿæµ‹è¯•ï¼ŒéªŒè¯æ•°æ®åº“å’Œçˆ¬è™«åŠŸèƒ½
python test_system.py
```

---

## Nitter å®ä¾‹ç®¡ç†

Nitter æ˜¯ Twitter çš„éšç§å‹å¥½å‰ç«¯ï¼Œé€šè¿‡ä½¿ç”¨å¤šä¸ªå¯ç”¨å®ä¾‹å¯ä»¥æé«˜ç³»ç»Ÿç¨³å®šæ€§ã€‚

### è‡ªåŠ¨å‘ç°å¯ç”¨å®ä¾‹

ä½¿ç”¨ `discover_instances.py` è„šæœ¬è‡ªåŠ¨æ£€æµ‹å¯ç”¨çš„ Nitter å®ä¾‹ï¼š

```bash
# åŸºæœ¬ä½¿ç”¨ï¼šå‘ç°å¹¶åˆ—å‡ºå¯ç”¨å®ä¾‹ï¼ˆä¼˜å…ˆä» Redis ç¼“å­˜è¯»å–ï¼‰
python discover_instances.py

# å‘ç°å‰ 8 ä¸ªæœ€å¿«çš„å®ä¾‹
python discover_instances.py --count 8

# è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
python discover_instances.py --timeout 10

# åªæ˜¾ç¤ºå“åº”æ—¶é—´å°äº 3 ç§’çš„å®ä¾‹
python discover_instances.py --max-response-time 3.0

# å¼ºåˆ¶åˆ·æ–°ç¼“å­˜ï¼Œé‡æ–°æ£€æµ‹æ‰€æœ‰å®ä¾‹ï¼ˆå¿½ç•¥ Redis ç¼“å­˜ï¼‰
python discover_instances.py --count 8 --max-response-time 4.0 --force-refresh

# ä¸ä»ç¬¬ä¸‰æ–¹æ¥æºè·å–ï¼Œä»…ä½¿ç”¨å†…ç½®å®ä¾‹åˆ—è¡¨
python discover_instances.py --no-external
```

**è¾“å‡ºç¤ºä¾‹ï¼ˆé¦–æ¬¡è¿è¡Œæˆ–å¼ºåˆ¶åˆ·æ–°ï¼‰**ï¼š
```
================================================================================
Nitter å®ä¾‹å¥åº·æ£€æµ‹
================================================================================

âš¡ å¼ºåˆ¶åˆ·æ–°æ¨¡å¼ï¼Œå¿½ç•¥ç¼“å­˜

âœ“ å¯ç”¨å®ä¾‹ 7 ä¸ª:

  1. https://nitter.catsarch.com
  2. https://nitter.pufe.org
  3. https://nitter.net
  4. https://xcancel.com
  5. https://bird.habedieeh.re
  6. https://nitter.privacyredirect.com
  7. https://nitter.adminforge.de

ğŸ’¡ å®ä¾‹åˆ—è¡¨å·²ç¼“å­˜åˆ° Redisï¼ˆæœ‰æ•ˆæœŸ 3 å°æ—¶ï¼‰
   ä¸‹æ¬¡è°ƒç”¨å°†ç›´æ¥ä»ç¼“å­˜è¯»å–ï¼Œæ— éœ€é‡æ–°æ£€æµ‹
================================================================================
```

**è¾“å‡ºç¤ºä¾‹ï¼ˆä»ç¼“å­˜è¯»å–ï¼‰**ï¼š
```
================================================================================
Nitter å®ä¾‹å¥åº·æ£€æµ‹
================================================================================

âœ“ å¯ç”¨å®ä¾‹ 7 ä¸ª:

  1. https://nitter.catsarch.com
  2. https://nitter.pufe.org
  3. https://nitter.net
  ...

ğŸ’¡ å®ä¾‹åˆ—è¡¨å·²ç¼“å­˜åˆ° Redisï¼ˆæœ‰æ•ˆæœŸ 3 å°æ—¶ï¼‰
   ä¸‹æ¬¡è°ƒç”¨å°†ç›´æ¥ä»ç¼“å­˜è¯»å–ï¼Œæ— éœ€é‡æ–°æ£€æµ‹
================================================================================
```

### å·¥ä½œåŸç†

å®ä¾‹å‘ç°ç³»ç»Ÿé‡‡ç”¨ **Redis ç¼“å­˜ä¼˜å…ˆ** çš„æ¨¡å—åŒ–æ¶æ„ï¼Œåˆ†ä¸ºä¸‰ä¸ªç‹¬ç«‹éƒ¨åˆ†ï¼š

#### 1. Redis ç¼“å­˜å±‚

- **ç¼“å­˜ä¼˜å…ˆç­–ç•¥**: ä¼˜å…ˆä» Redis ç¼“å­˜è¯»å–å¯ç”¨å®ä¾‹ï¼ˆ3 å°æ—¶æœ‰æ•ˆæœŸï¼‰
- **è‡ªåŠ¨åˆ·æ–°**: ç¼“å­˜è¿‡æœŸåè‡ªåŠ¨é‡æ–°æ£€æµ‹å¹¶æ›´æ–°
- **æ€§èƒ½ä¼˜åŒ–**: é¿å…é¢‘ç¹çš„å¥åº·æ£€æµ‹ï¼Œæé«˜å“åº”é€Ÿåº¦
- **åˆ†å¸ƒå¼å‹å¥½**: å¤šä¸ªçˆ¬è™«è¿›ç¨‹å¯å…±äº«åŒä¸€ä»½å®ä¾‹åˆ—è¡¨

#### 2. å®ä¾‹æ¥æºè·å– (`instance_sources.py`)

æ”¯æŒå¤šç§æ¥æºè·å–å®ä¾‹åˆ—è¡¨ï¼š

- **å†…ç½®å®ä¾‹**: 40+ ä¸ªå·²éªŒè¯çš„ Nitter å®ä¾‹ï¼ˆ`constants.py`ï¼‰
- **StatusPageSource**: ä» https://status.d420.de/ çŠ¶æ€ç›‘æ§ç½‘ç«™è·å–
- **å¯æ‰©å±•**: æ”¯æŒæ·»åŠ è‡ªå®šä¹‰æ¥æºï¼ˆGitHubã€APIã€RSS ç­‰ï¼‰

æ‰€æœ‰æ¥æºçš„å®ä¾‹ä¼šè‡ªåŠ¨å»é‡å’Œåˆå¹¶ã€‚

#### 3. å¥åº·æ£€æµ‹ (`instance_discovery.py`)

- **å¹¶å‘æ£€æµ‹**: åŒæ—¶æ£€æµ‹æ‰€æœ‰å®ä¾‹çš„å¯ç”¨æ€§å’Œå“åº”æ—¶é—´
- **æ™ºèƒ½è¿‡æ»¤**: éªŒè¯ HTTP çŠ¶æ€ç ã€å“åº”æ—¶é—´ã€é¡µé¢å†…å®¹
- **è‡ªåŠ¨æ’åº**: æŒ‰å“åº”æ—¶é—´ä»å¿«åˆ°æ…¢æ’åº
- **Redis å­˜å‚¨**: æ£€æµ‹ç»“æœè‡ªåŠ¨ä¿å­˜åˆ° Redisï¼ˆ3 å°æ—¶ TTLï¼‰

#### å·¥ä½œæµç¨‹

```
é¦–æ¬¡è¿è¡Œæˆ–å¼ºåˆ¶åˆ·æ–°:
[å†…ç½®åˆ—è¡¨] â”€â”
            â”œâ”€> [æ¥æºç®¡ç†å™¨] â”€> [å»é‡åˆå¹¶] â”€> [å¹¶å‘å¥åº·æ£€æµ‹] â”€> [æ’åº] â”€> [Redis ç¼“å­˜] â”€> [å¯ç”¨å®ä¾‹åˆ—è¡¨]
[çŠ¶æ€é¡µé¢] â”€â”˜                                                     (3å°æ—¶TTL)

åç»­è°ƒç”¨ï¼ˆç¼“å­˜æœªè¿‡æœŸï¼‰:
[Redis ç¼“å­˜] â”€> [å¯ç”¨å®ä¾‹åˆ—è¡¨]  (ç§’çº§å“åº”)
```

### çˆ¬è™«å¦‚ä½•è·å–å®ä¾‹

**NitterCrawler** ç°åœ¨è‡ªåŠ¨ä» Redis ç¼“å­˜è·å–å¯ç”¨å®ä¾‹ï¼š

```python
from src.crawler.nitter_crawler import NitterCrawler

# åˆå§‹åŒ–çˆ¬è™«ï¼ˆé»˜è®¤ä» Redis è·å–å®ä¾‹ï¼‰
crawler = NitterCrawler(use_redis_instances=True)

# è·å–æ¨æ–‡ï¼ˆä¼šè‡ªåŠ¨é€‰æ‹©æœ€å¿«çš„å®ä¾‹ï¼‰
tweets = crawler.fetch_user_timeline("elonmusk", max_tweets=20)
```

**è‡ªåŠ¨åˆ·æ–°æœºåˆ¶**ï¼š
- çˆ¬è™«æ¯ 10 åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡å®ä¾‹åˆ—è¡¨ï¼ˆä» Redis è¯»å–ï¼‰
- å®ä¾‹æŒ‰å“åº”é€Ÿåº¦æ’åºï¼Œä½¿ç”¨åŠ æƒéšæœºé€‰æ‹©ï¼ˆæ›´å¿«çš„å®ä¾‹è¢«é€‰ä¸­æ¦‚ç‡æ›´é«˜ï¼‰
- å¦‚æœ Redis ç¼“å­˜ä¸ºç©ºæˆ–è¿‡æœŸï¼Œä¼šè‡ªåŠ¨è§¦å‘é‡æ–°æ£€æµ‹

### å†…ç½®å®ä¾‹é…ç½®

ç³»ç»Ÿå†…ç½®äº† 40+ ä¸ªå·²éªŒè¯çš„ Nitter å®ä¾‹ï¼Œå®šä¹‰åœ¨ `src/crawler/constants.py` ä¸­ï¼š

```python
# src/crawler/constants.py
KNOWN_INSTANCES = [
    "https://nitter.catsarch.com",
    "https://nitter.pufe.org",
    "https://nitter.net",
    "https://xcancel.com",
    # ... æ›´å¤šå®ä¾‹
]
```

å¦‚éœ€ä¿®æ”¹å†…ç½®åˆ—è¡¨ï¼Œç›´æ¥ç¼–è¾‘è¯¥æ–‡ä»¶å³å¯ã€‚

### Redis ç¼“å­˜ç®¡ç†

æŸ¥çœ‹å’Œç®¡ç† Redis ä¸­çš„å®ä¾‹ç¼“å­˜ï¼š

```bash
# è¿æ¥ Redis
docker-compose exec redis redis-cli -a xin_x

# æŸ¥çœ‹ç¼“å­˜çš„å®ä¾‹åˆ—è¡¨
GET nitter:instances:available

# æŸ¥çœ‹ç¼“å­˜å‰©ä½™æ—¶é—´ï¼ˆç§’ï¼‰
TTL nitter:instances:available

# æ‰‹åŠ¨åˆ é™¤ç¼“å­˜ï¼ˆä¸‹æ¬¡çˆ¬è™«è¿è¡Œæ—¶ä¼šè‡ªåŠ¨é‡æ–°æ£€æµ‹ï¼‰
DEL nitter:instances:available

# é€€å‡º
exit
```

### å®šæœŸæ›´æ–°å®ä¾‹åˆ—è¡¨

ç³»ç»Ÿé‡‡ç”¨ **è‡ªåŠ¨è¿‡æœŸåˆ·æ–°** æœºåˆ¶ï¼Œæ— éœ€æ‰‹åŠ¨å®šæœŸæ›´æ–°ï¼š

#### è‡ªåŠ¨åˆ·æ–°ç­–ç•¥

1. **Redis ç¼“å­˜è‡ªåŠ¨è¿‡æœŸ**: å®ä¾‹åˆ—è¡¨åœ¨ Redis ä¸­ä¿å­˜ 3 å°æ—¶åè‡ªåŠ¨è¿‡æœŸ
2. **çˆ¬è™«è‡ªåŠ¨åˆ·æ–°**: NitterCrawler æ¯ 10 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ Redisï¼Œå¦‚æœç¼“å­˜è¿‡æœŸä¼šè‡ªåŠ¨é‡æ–°æ£€æµ‹
3. **é›¶ç»´æŠ¤**: å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€é…ç½® crontab

#### æ‰‹åŠ¨å¼ºåˆ¶åˆ·æ–°ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ç«‹å³æ›´æ–°å®ä¾‹åˆ—è¡¨ï¼ˆä¾‹å¦‚å‘ç°æ‰€æœ‰å®ä¾‹éƒ½ä¸å¯ç”¨ï¼‰ï¼š

```bash
# å¼ºåˆ¶åˆ·æ–°å¹¶æ›´æ–° Redis ç¼“å­˜
python discover_instances.py --force-refresh

# æŸ¥çœ‹åˆ·æ–°åçš„å®ä¾‹
python discover_instances.py
```

#### ç›‘æ§å®ä¾‹å¥åº·çŠ¶æ€

```bash
# æŸ¥çœ‹å½“å‰ç¼“å­˜çš„å®ä¾‹æ•°é‡å’Œå‰©ä½™æ—¶é—´
docker-compose exec redis redis-cli -a xin_x TTL nitter:instances:available

# å¦‚æœè¿”å› -2ï¼Œè¯´æ˜ç¼“å­˜å·²è¿‡æœŸï¼ˆä¸‹æ¬¡çˆ¬è™«è¿è¡Œä¼šè‡ªåŠ¨åˆ·æ–°ï¼‰
# å¦‚æœè¿”å›æ­£æ•°ï¼Œè¯´æ˜ç¼“å­˜è¿˜æœ‰ N ç§’æœ‰æ•ˆæœŸ
# å¦‚æœè¿”å› -1ï¼Œè¯´æ˜ç¼“å­˜æ°¸ä¹…æœ‰æ•ˆï¼ˆä¸åº”è¯¥å‡ºç°ï¼‰
```

### æŸ¥çœ‹å½“å‰å¯ç”¨å®ä¾‹

```bash
# æ–¹å¼ 1: ä½¿ç”¨å‘ç°è„šæœ¬æŸ¥çœ‹ï¼ˆä» Redis è¯»å–ï¼‰
python discover_instances.py

# æ–¹å¼ 2: ç›´æ¥æŸ¥çœ‹ Redis ç¼“å­˜
docker-compose exec redis redis-cli -a xin_x GET nitter:instances:available

# æ–¹å¼ 3: ä½¿ç”¨ Python æŸ¥çœ‹
python -c "
from src.crawler.instance_discovery import NitterInstanceDiscovery
discovery = NitterInstanceDiscovery()
instances = discovery.get_available_instances()
for i, inst in enumerate(instances, 1):
    print(f'{i}. {inst[\"url\"]} ({inst[\"response_time\"]:.2f}s)')
"

# æ–¹å¼ 4: æŸ¥çœ‹å†…ç½®å®ä¾‹åˆ—è¡¨
python -c "from src.crawler.constants import KNOWN_INSTANCES; print('\n'.join(KNOWN_INSTANCES))"
```

### å®ä¾‹å¥åº·çŠ¶æ€åˆ¤æ–­æ ‡å‡†

è„šæœ¬é€šè¿‡ä»¥ä¸‹æ ‡å‡†åˆ¤æ–­å®ä¾‹æ˜¯å¦å¯ç”¨ï¼š
- âœ“ HTTP çŠ¶æ€ç ä¸º 200
- âœ“ å“åº”æ—¶é—´åœ¨è®¾å®šèŒƒå›´å†…
- âœ“ é¡µé¢å†…å®¹åŒ…å« Nitter ç›¸å…³ç‰¹å¾
- âœ“ URL åŒ…å« nitter/bird/twitter ç­‰å…³é”®è¯

### æ‰©å±•è‡ªå®šä¹‰å®ä¾‹æ¥æº

ç³»ç»Ÿæ”¯æŒæ·»åŠ æ–°çš„å®ä¾‹æ¥æºã€‚æŸ¥çœ‹ `src/crawler/README_SOURCES.md` äº†è§£è¯¦æƒ…ã€‚

ç¤ºä¾‹ï¼šæ·»åŠ  GitHub æ¥æº

```python
from src.crawler.instance_sources import InstanceSource, InstanceSourceManager

class GitHubSource(InstanceSource):
    def get_source_name(self) -> str:
        return "GitHub"

    def fetch_instances(self) -> List[str]:
        # ä» GitHub è·å–å®ä¾‹åˆ—è¡¨
        # ... å®ç°é€»è¾‘
        return instances

# ä½¿ç”¨è‡ªå®šä¹‰æ¥æº
manager = InstanceSourceManager()
manager.add_source(GitHubSource())
```

è¯¦ç»†æ•™ç¨‹è¯·å‚è€ƒ `src/crawler/README_SOURCES.md`ã€‚

---

## ç”¨æˆ·ç®¡ç†

### æ·»åŠ ç›‘å¬ç”¨æˆ·

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼ˆæ¨èï¼‰

```bash
# æ·»åŠ å•ä¸ªç”¨æˆ·
python manage_users.py add <username> --name "æ˜¾ç¤ºåç§°" --priority ä¼˜å…ˆçº§

# ç¤ºä¾‹ï¼š
python manage_users.py add elonmusk --name "Elon Musk" --priority 10
python manage_users.py add naval --name "Naval Ravikant" --priority 9
python manage_users.py add VitalikButerin --name "Vitalik Buterin" --priority 8
```

**å‚æ•°è¯´æ˜**ï¼š
- `username`: X/Twitter ç”¨æˆ·åï¼ˆå¿…å¡«ï¼‰
- `--name`: æ˜¾ç¤ºåç§°ï¼ˆå¯é€‰ï¼‰
- `--priority`: ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼ˆå¯é€‰ï¼Œé»˜è®¤ 0ï¼‰

**æ‰¹é‡æ·»åŠ ç¤ºä¾‹**ï¼š

```bash
# åŠ å¯†è´§å¸ KOL
python manage_users.py add VitalikButerin --name "Vitalik Buterin" --priority 10
python manage_users.py add cz_binance --name "CZ" --priority 10
python manage_users.py add elonmusk --name "Elon Musk" --priority 9
python manage_users.py add balajis --name "Balaji Srinivasan" --priority 8
python manage_users.py add APompliano --name "Anthony Pompliano" --priority 7

# AI é¢†åŸŸ
python manage_users.py add sama --name "Sam Altman" --priority 10
python manage_users.py add ylecun --name "Yann LeCun" --priority 9
python manage_users.py add karpathy --name "Andrej Karpathy" --priority 9

# ç§‘æŠ€æŠ•èµ„
python manage_users.py add naval --name "Naval Ravikant" --priority 10
python manage_users.py add chamath --name "Chamath Palihapitiya" --priority 8
python manage_users.py add paulg --name "Paul Graham" --priority 8
```

#### æ–¹å¼äºŒï¼šç›´æ¥æ“ä½œæ•°æ®åº“

é€‚åˆæ‰¹é‡æ·»åŠ å¤§é‡ç”¨æˆ·ï¼š

```bash
# è¿æ¥åˆ° PostgreSQL
docker-compose exec postgres psql -U nitter_user -d nitter_x
```

æ‰§è¡Œ SQLï¼š

```sql
-- æ‰¹é‡æ·»åŠ ç”¨æˆ·
INSERT INTO watched_users (username, display_name, priority) VALUES
    ('elonmusk', 'Elon Musk', 10),
    ('naval', 'Naval Ravikant', 9),
    ('VitalikButerin', 'Vitalik Buterin', 8),
    ('cathiedwood', 'Cathie Wood', 7),
    ('balajis', 'Balaji Srinivasan', 6)
ON CONFLICT (username) DO NOTHING;

-- æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·
SELECT * FROM watched_users ORDER BY priority DESC;

-- é€€å‡º
\q
```

### æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨

```bash
python manage_users.py list
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
å…±æœ‰ 5 ä¸ªå…³æ³¨ç”¨æˆ·:

ID    ç”¨æˆ·å                æ˜¾ç¤ºåç§°                         ä¼˜å…ˆçº§    çŠ¶æ€      æœ€åé‡‡é›†æ—¶é—´
----------------------------------------------------------------------------------------------------
1     elonmusk            Elon Musk                      10       æ´»è·ƒ      2025-12-22 10:30:00
2     naval               Naval Ravikant                 9        æ´»è·ƒ      2025-12-22 10:28:00
3     VitalikButerin      Vitalik Buterin                8        æ´»è·ƒ      ä»æœª
```

### å¯ç”¨/ç¦ç”¨ç”¨æˆ·

```bash
# ç¦ç”¨ç”¨æˆ·ï¼ˆä¸åˆ é™¤ï¼Œæš‚åœé‡‡é›†ï¼‰
python manage_users.py disable elonmusk

# é‡æ–°å¯ç”¨ç”¨æˆ·
python manage_users.py enable elonmusk
```

### åˆ é™¤ç”¨æˆ·

```bash
# æ°¸ä¹…åˆ é™¤ç”¨æˆ·ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
python manage_users.py remove elonmusk
```

---

## æ¨æ–‡é‡‡é›†

### è¿è¡Œé‡‡é›†ä»»åŠ¡

```bash
# æ‰§è¡Œä¸€æ¬¡é‡‡é›†
python main.py
```

**å·¥ä½œæµç¨‹**ï¼š
1. ä»æ•°æ®åº“è¯»å–æ‰€æœ‰æ´»è·ƒçš„å…³æ³¨ç”¨æˆ·
2. æŒ‰ä¼˜å…ˆçº§é¡ºåºéå†æ¯ä¸ªç”¨æˆ·
3. ä» Nitter å®ä¾‹è·å–ç”¨æˆ·æœ€æ–°æ¨æ–‡
4. ä¸æ•°æ®åº“ä¸­æœ€æ–°æ¨æ–‡ ID å¯¹æ¯”ï¼Œåªé‡‡é›†æ–°æ¨æ–‡
5. å»é‡åå­˜å…¥ PostgreSQL
6. æ¨é€ tweet_id åˆ° Redis å¤„ç†é˜Ÿåˆ—ï¼ˆé¢„ç•™ï¼Œv3.0.0 ä½¿ç”¨ï¼‰
7. æ›´æ–°ç”¨æˆ·çš„æœ€åé‡‡é›†æ—¶é—´

**é‡‡é›†æ—¥å¿—**ï¼š

æ—¥å¿—ä¿å­˜åœ¨ `logs/crawler.log`ï¼Œå¯ä»¥æŸ¥çœ‹ï¼š

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/crawler.log

# æŸ¥çœ‹æœ€è¿‘ 50 è¡Œ
tail -50 logs/crawler.log
```

### å®šæ—¶é‡‡é›†ï¼ˆå¯é€‰ï¼‰

ä½¿ç”¨ cron å®šæ—¶æ‰§è¡Œé‡‡é›†ä»»åŠ¡ï¼š

```bash
# ç¼–è¾‘ crontab
crontab -e

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼Œæ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡
0 * * * * cd /path/to/nitter_x && /path/to/python main.py >> logs/cron.log 2>&1

# æˆ–æ¯ 30 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
*/30 * * * * cd /path/to/nitter_x && /path/to/python main.py >> logs/cron.log 2>&1
```

---

## æ•°æ®æŸ¥è¯¢

### ä½¿ç”¨ SQL æŸ¥è¯¢

```bash
# è¿æ¥æ•°æ®åº“
docker-compose exec postgres psql -U nitter_user -d nitter_x
```

**å¸¸ç”¨æŸ¥è¯¢**ï¼š

```sql
-- 1. æŸ¥çœ‹é‡‡é›†ç»Ÿè®¡
SELECT
    author,
    COUNT(*) as tweet_count,
    MAX(published_at) as latest_tweet
FROM tweets
GROUP BY author
ORDER BY tweet_count DESC;

-- 2. æŸ¥çœ‹æœ€æ–°æ¨æ–‡
SELECT
    tweet_id,
    author,
    LEFT(content, 100) as content_preview,
    published_at
FROM tweets
ORDER BY published_at DESC
LIMIT 20;

-- 3. æŸ¥çœ‹æŸä¸ªç”¨æˆ·çš„æ¨æ–‡
SELECT
    tweet_id,
    LEFT(content, 150) as content,
    published_at
FROM tweets
WHERE author = 'elonmusk'
ORDER BY published_at DESC
LIMIT 10;

-- 4. æŒ‰æ—¥æœŸç»Ÿè®¡æ¨æ–‡æ•°é‡
SELECT
    DATE(published_at) as date,
    COUNT(*) as tweet_count
FROM tweets
GROUP BY DATE(published_at)
ORDER BY date DESC
LIMIT 7;

-- 5. æŸ¥çœ‹ç”¨æˆ·é‡‡é›†çŠ¶æ€
SELECT
    username,
    display_name,
    priority,
    is_active,
    last_crawled_at,
    (SELECT COUNT(*) FROM tweets WHERE author = watched_users.username) as tweet_count
FROM watched_users
ORDER BY priority DESC;

-- 6. æŸ¥çœ‹ä»Šå¤©é‡‡é›†çš„æ¨æ–‡
SELECT
    author,
    COUNT(*) as count
FROM tweets
WHERE DATE(created_at) = CURRENT_DATE
GROUP BY author;
```

### æ•°æ®å¯¼å‡º

```bash
# å¯¼å‡ºæ‰€æœ‰æ¨æ–‡åˆ° CSV
docker-compose exec postgres psql -U nitter_user -d nitter_x -c "\COPY (SELECT * FROM tweets ORDER BY published_at DESC) TO STDOUT CSV HEADER" > tweets.csv

# å¯¼å‡ºæŸä¸ªç”¨æˆ·çš„æ¨æ–‡
docker-compose exec postgres psql -U nitter_user -d nitter_x -c "\COPY (SELECT * FROM tweets WHERE author='elonmusk' ORDER BY published_at DESC) TO STDOUT CSV HEADER" > elonmusk_tweets.csv
```

---

## ç³»ç»Ÿæµ‹è¯•

### æµ‹è¯•æ‰€æœ‰ç»„ä»¶

```bash
python test_system.py
```

æµ‹è¯•å†…å®¹ï¼š
- PostgreSQL è¿æ¥
- Redis è¿æ¥
- Nitter çˆ¬è™«åŠŸèƒ½

### æµ‹è¯•å•ä¸ªæ¨¡å—

```python
# æµ‹è¯•çˆ¬è™«
from src.crawler.nitter_crawler import NitterCrawler
crawler = NitterCrawler()
tweets = crawler.fetch_user_timeline("elonmusk", max_tweets=5)
print(f"è·å–åˆ° {len(tweets)} æ¡æ¨æ–‡")

# æµ‹è¯•æ•°æ®åº“
from src.storage.postgres_client import get_postgres_client
pg = get_postgres_client()
users = pg.get_watched_users()
print(f"å…³æ³¨ç”¨æˆ·æ•°: {len(users)}")

# æµ‹è¯• Redis
from src.storage.redis_client import get_redis_client
redis = get_redis_client()
redis.push_to_queue("test_queue", {"test": "data"})
data = redis.pop_from_queue("test_queue", timeout=1)
print(f"Redis æµ‹è¯•æ•°æ®: {data}")
```

---

## å¸¸è§é—®é¢˜

### 1. å¦‚ä½•æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼Ÿ

```bash
# æŸ¥çœ‹ Docker æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs postgres
docker-compose logs redis
```

### 2. å¦‚ä½•é‡ç½®æ•°æ®åº“ï¼Ÿ

```bash
# åœæ­¢æœåŠ¡å¹¶åˆ é™¤æ•°æ®å·
docker-compose down -v

# é‡æ–°å¯åŠ¨ï¼ˆä¼šè‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“ï¼‰
docker-compose up -d
```

### 3. å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ

```bash
# å¤‡ä»½æ•°æ®åº“
docker-compose exec postgres pg_dump -U nitter_user nitter_x > backup_$(date +%Y%m%d).sql

# æ¢å¤æ•°æ®åº“
cat backup_20251222.sql | docker-compose exec -T postgres psql -U nitter_user nitter_x
```

### 4. Nitter å®ä¾‹ä¸å¯ç”¨æ€ä¹ˆåŠï¼Ÿ

ç³»ç»Ÿä¼šè‡ªåŠ¨ä» Redis ç¼“å­˜ä¸­é€‰æ‹©å¯ç”¨å®ä¾‹ï¼Œå¹¶æŒ‰å“åº”é€Ÿåº¦ä¼˜å…ˆé€‰æ‹©ã€‚

å¦‚æœæ‰€æœ‰å®ä¾‹éƒ½ä¸å¯ç”¨ï¼Œå¯ä»¥ï¼š

**æ–¹æ³• 1: å¼ºåˆ¶åˆ·æ–°å®ä¾‹åˆ—è¡¨ï¼ˆæ¨èï¼‰**
```bash
# å¼ºåˆ¶é‡æ–°æ£€æµ‹å¹¶æ›´æ–° Redis ç¼“å­˜
python discover_instances.py --force-refresh
```

**æ–¹æ³• 2: æ£€æŸ¥ Redis ç¼“å­˜çŠ¶æ€**
```bash
# æŸ¥çœ‹ç¼“å­˜çš„å®ä¾‹æ•°é‡
docker-compose exec redis redis-cli -a xin_x GET nitter:instances:available

# æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜ï¼ˆä¸‹æ¬¡çˆ¬è™«ä¼šè‡ªåŠ¨é‡æ–°æ£€æµ‹ï¼‰
docker-compose exec redis redis-cli -a xin_x DEL nitter:instances:available
```

**æ–¹æ³• 3: æ·»åŠ æ–°çš„å†…ç½®å®ä¾‹**
```bash
# ç¼–è¾‘å†…ç½®å®ä¾‹åˆ—è¡¨
nano src/crawler/constants.py

# æ·»åŠ æ–°çš„ URL åˆ° KNOWN_INSTANCES åˆ—è¡¨
# ç„¶åå¼ºåˆ¶åˆ·æ–°
python discover_instances.py --force-refresh
```

### 5. å¦‚ä½•è°ƒæ•´é‡‡é›†é¢‘ç‡ï¼Ÿ

ä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„å‚æ•°ï¼š

```bash
# ç¼–è¾‘ .env
nano .env

# è°ƒæ•´ä»¥ä¸‹å‚æ•°
CRAWLER_TIMEOUT=30        # è¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰
CRAWLER_RETRY=3           # é‡è¯•æ¬¡æ•°
CRAWLER_DELAY=2.0         # æ¯ä¸ªç”¨æˆ·é‡‡é›†é—´éš”ï¼ˆç§’ï¼‰
```

### 6. æŸ¥çœ‹ Redis é˜Ÿåˆ—çŠ¶æ€

```bash
# è¿æ¥ Redis
docker-compose exec redis redis-cli -a xin_x

# æŸ¥çœ‹å¤„ç†é˜Ÿåˆ—é•¿åº¦
LLEN queue:process

# æŸ¥çœ‹é˜Ÿåˆ—å†…å®¹
LRANGE queue:process 0 10

# é€€å‡º
exit
```

### 7. æ¸…ç©ºæ‰€æœ‰æ•°æ®

```bash
# æ¸…ç©ºæ¨æ–‡è¡¨
docker-compose exec postgres psql -U nitter_user -d nitter_x -c "TRUNCATE TABLE tweets, processing_logs;"

# æ¸…ç©º Redis é˜Ÿåˆ—
docker-compose exec redis redis-cli -a xin_x FLUSHDB
```

---

## è¿›é˜¶ä½¿ç”¨

### è‡ªå®šä¹‰é…ç½®

æ‰€æœ‰é…ç½®åœ¨ `.env` æ–‡ä»¶ä¸­ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ï¼š

```bash
# PostgreSQL é…ç½®
POSTGRES_PORT=5433
POSTGRES_PASSWORD=your_password

# Redis é…ç½®
REDIS_PASSWORD=your_redis_password

# æ—¥å¿—çº§åˆ«
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR

# çˆ¬è™«é…ç½®
CRAWLER_TIMEOUT=30
CRAWLER_RETRY=3
CRAWLER_DELAY=1.0
```

**æ³¨æ„**: Nitter å®ä¾‹ç°åœ¨é€šè¿‡ Redis ç¼“å­˜è‡ªåŠ¨ç®¡ç†ï¼Œä¸å†éœ€è¦åœ¨ `.env` ä¸­é…ç½®ã€‚å¦‚éœ€ä¿®æ”¹å†…ç½®å®ä¾‹åˆ—è¡¨ï¼Œè¯·ç¼–è¾‘ `src/crawler/constants.py`ã€‚

### æŸ¥çœ‹é¡¹ç›®ç»“æ„

```bash
# æŸ¥çœ‹ç›®å½•ç»“æ„
tree -L 3 -I '__pycache__|*.pyc|.git|.idea|.venv'

# æˆ–æŸ¥çœ‹æ–‡æ¡£
cat PROJECT_STRUCTURE.md
```

---

## åç»­ç‰ˆæœ¬é¢„å‘Š

- **v3.0.0**: å†…å®¹å¤„ç†ä¸åˆ†æ
  - æ–‡æœ¬æ¸…æ´—
  - LLM æ ‡ç­¾ç³»ç»Ÿ
  - æƒé‡ä¸ç­‰çº§è®¡ç®—

- **v4.0.0**: å†…å®¹å±•ç¤º
  - Streamlit Web ç•Œé¢
  - å¤šç»´åº¦ç­›é€‰
  - Webhook æ¨é€

---

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ `README.md` å’Œ `DEPLOYMENT.md`
2. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ `logs/crawler.log`
3. æäº¤ Issue åˆ°é¡¹ç›®ä»“åº“
